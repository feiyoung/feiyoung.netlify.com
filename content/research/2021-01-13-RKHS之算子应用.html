---
title: "再生核方法-第四章 算子的应用"
author: "刘伟"
date: '2021-01-13'
output: pdf_document
layout: post
---

<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<p><strong>再生核方法-第四章 算子的应用</strong></p>
<div id="一般非线性回归的变量选择" class="section level1">
<h1>一般非线性回归的变量选择</h1>
<p>考虑模型
<span class="math display">\[y_i = f^*(x_i) + \varepsilon_i,\]</span>
其中<span class="math inline">\(x_i \in R^d\)</span>，中<span class="math inline">\(f^*\)</span>来自于一个对称正定核<span class="math inline">\(k\)</span>诱导出的再生核希尔伯特空间<span class="math inline">\(\mathcal{H}\)</span>。。 定义偏导函数的<span class="math inline">\(L_2(P)\)</span>范数
<span class="math display">\[\|\frac{\partial f}{\partial x^a}\|_P= \sqrt{\int (\frac{\partial f(x)}{\partial x^a})^2 dP(x)}. \tag{1.1}\]</span>
在一定条件下，有<span class="math inline">\(\|\frac{\partial f}{\partial x^a}\|_P=0 \Rightarrow ~~ f\)</span>关于<span class="math inline">\(x_a\)</span>是常数。
<span class="math inline">\((1.1)\)</span>的样本版本为
<span class="math display">\[\|\frac{\partial f}{\partial x^a}\|_n= \sqrt{\frac{1}{n} \sum_{i=1}^n (\frac{\partial f(x_i)}{\partial x^a})^2},\]</span>
其中<span class="math inline">\(\frac{\partial f}{\partial x^a}\)</span>表示<span class="math inline">\(f\)</span>关于第<span class="math inline">\(a\)</span>个分量的偏导数。</p>
<p>我们考虑如下最小化如下正则化的泛函来求解函数<span class="math inline">\(f\)</span>，并实现变量选择，
<span class="math display">\[\hat E^\tau(f) = \frac{1}{n} \sum_{i=1}^n (y_i - f(x_i))^2 + \tau (2\hat \Omega_1^D(f) + \nu \|f\|^2_{\mathcal{H}}). \tag{1.2}\]</span>
添加<span class="math inline">\(\nu \|f\|^2_{\mathcal{H}}\)</span>项是为了泛函的强凸性，从而保证解的唯一性，也保证算法的稳定性。</p>
</div>
<div id="推导新的表示定理" class="section level1">
<h1>推导新的表示定理</h1>
<p>由核函数的再生性可得,对<span class="math inline">\(\forall ~f\in \mathcal{H}, x\in \mathcal{X},\)</span>
<span class="math display">\[f(x) = \langle f, k_x \rangle_H\]</span>
定义抽样算子<span class="math inline">\(\hat S\)</span>，它输出一个函数<span class="math inline">\(f\in \mathcal{H}\)</span>在样本点的取值，即
<span class="math display">\[\hat S: \mathcal{H} \rightarrow R^n,~~~~(\hat S f)_i=\langle f, k_{x_i}\rangle,~~i=1,\cdots,n.\]</span>
如果核函数有界，则该算子是线性且有界的（见参考文献）。由定义和再生性可知：<span class="math inline">\((\hat S f)_i=f(x_i).\)</span></p>
<p>下面介绍一下再生核理论如何实现导数的有效计算。记核函数关于第一个变量的偏导数为
<span class="math display">\[(\partial_a k)_x\equiv \frac{\partial k(s,\cdot)}{\partial s^a}|_{s=x}.\]</span></p>
<p>根据Zhou(2008)中定理1有：如果<span class="math inline">\(k\)</span>为至少二次可微函数(<span class="math inline">\(k\in C^2(\mathcal{X}\times \mathcal{X})\)</span>)，则对<span class="math inline">\(\forall x \in \mathcal{X}\)</span>有<span class="math inline">\((\partial_a k)_x\in \mathcal{H}\)</span>并且对于<span class="math inline">\(a=1,\cdots,d,\)</span>
<span class="math display">\[\frac{\partial f}{\partial x^a} = \langle f, (\partial_a k)_x \rangle.\]</span>
于是，关于导数可以定义类似的抽样算子：
<span class="math display">\[\hat D_a: \mathcal{H} \rightarrow R^n,~~~~(\hat D_a f)_i=\langle f, (\partial_a k)_{x_i}\rangle,~~i=1,\cdots,n.\]</span>
进一步，定义经验梯度算子：<span class="math inline">\(\hat \nabla: \mathcal{H} \rightarrow (R^n)^d,~~ \hat\nabla f= (\hat D_a f, a=1,\cdots,d)\)</span>. 在一定条件下，可以证明这些算子都是线性且有界的。</p>
<p>记<span class="math inline">\(F(f)=\frac{1}{n} \sum_{i=1}^n (y_i - f(x_i))^2 + \tau\nu \|f\|^2_{\mathcal{H}}\)</span>，则根据算子定义，可以重写成：
<span class="math display">\[F(f) =\frac{1}{n}\|Y- \hat S f\|^2 + \tau\nu \|f\|^2_{\mathcal{H}}, \tag{1.3}\]</span>
其中<span class="math inline">\(Y=(y_1,\cdots, y_n)^T\)</span>。于是，泛函<span class="math inline">\(F\)</span>关于<span class="math inline">\(f\)</span>的导数为
<span class="math display">\[\nabla F(f)=\frac{2}{n} \hat S^* (\hat S f -Y) + 2\tau \nu f,\]</span>
其中<span class="math inline">\(\hat S^*\)</span>为<span class="math inline">\(\hat S\)</span>的伴随算子。</p>
<pre class="rmd"><code>本内容参考文献：
Rosasco, et al., Nonparameteric Sparsity and Regularization, 2013, JMLR.</code></pre>
</div>
