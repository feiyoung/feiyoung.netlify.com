---
title: "Linux操作手册"
author: "刘伟"
date: '2021-03-02'
output: pdf_document
---

## 账户
账户信息
```{linux}
GPU:
ssh weiliudeng@172.25.136.22
Ldw-258174718

```

## 基本命令
```{linux}
可用命令： 
cd 路径                        更改远程目录到“路径” 
lcd 路径                       更改本地目录到“路径” 
chgrp group path               将文件“path”的组更改为“group” 
chmod mode path                将文件“path”的权限更改为“mode” 
chown owner path               将文件“path”的属主更改为“owner” 
exit                           退出 sftp 
help                           显示这个帮助文本 
get 远程路径                   下载文件 
ln existingpath linkpath       符号链接远程文件 
ls [选项] [路径]               显示远程目录列表 
lls [选项] [路径]              显示本地目录列表 
mkdir 路径                     创建远程目录 
lmkdir 路径                    创建本地目录 
mv oldpath newpath             移动远程文件 
open [用户@]主机[:端口]        连接到远程主机 
put 本地路径                   上传文件 
pwd                            显示远程工作目录 
lpwd                           打印本地工作目录 
quit                           退出 sftp 
rmdir 路径                     移除远程目录 
lrmdir 路径                    移除本地目录 
rm 路径                        删除远程文件 
lrm 路径                       删除本地文件 
symlink existingpath linkpath  符号链接远程文件 
version                        显示协议版本 
exit/logout                   退出linux连接
cd /home/csr3/ #进入到指定路径
cd .. # 返回上一级命令

```

## 文件操作命令
```{linux}
stat A.txt    查看文件的创建日期等详细信息
cp -options A B    将文件（夹）A复制为文件（夹）B。
tar -xzvf  XX.tar.gz      解压压缩文件
从指定网址下载文件：
wget -O spaceranger-1.2.2.tar.gz "https://cf.10xgenomics.com/releases/spatial-exp/spaceranger-1.2.2.tar.gz" 
设置环境变量：
export PATH=/opt/spaceranger-1.2.2:$PATH
如：export PATH=/home/hangweiqiang/spaceranger/spaceranger-1.2.2:$PATH
pwd 获取当前绝对路径
man bash 查看某个命令（比如bash)的介绍。
head -2 XX.csv 查看文件的前两行
cat xx.txt  打印出文件内容
```

## 远程linux服务器提交计算任务
新建一个xx.sh文件
```{linux}
#!/bin/bash
#PBS -N SCLMM_IS_power_rho0.8_lam0.8_h20.001
#PBS -l select=1:ncpus=1:mem=90GB
#PBS -l walltime=24:00:00
#PBS -l place=pack
#PBS -j oe
#PBS -o /home/users/nus/gmsyan/SCLMM/simulation/submit_code/SCLMM_IS_power_rho0.8_lam0.8_h20.001.log
module load R
module load gcc/5.1.0
cd /home/users/nus/gmsyan/SCLMM/simulation/submit_code
R CMD BATCH /home/users/nus/gmsyan/SCLMM/simulation/submit_code/SCLMM_IS_power_rho0.8_lam0.8_h20.001.R
```

## Module环境变量管理工具

使用module环境变量管理工具可以很方便管理linux中的环境变量，用户不需要修改.bashrc，从而避免误操作。

1. module load | add 加载环境变量
module unload | rm 移除环境变量
```{linux}
module load R  #加载R,或者使用module add R
which R   # （查看是否加载成功）
# 结果：/app/R/R-3.5.3/bin/R
module unload R #从环境变量中移除R，或者使用module rm R
module load gcc/5.1.0 #加载gcc的5.1.0版本
module swap R R/3.6.0 # 将当前环境变量中的R替换成R3.6.0版本作为环境变量
```

2. module avail -- 显示系统可用的编译器及库

3.  module list  显示用户加载的编译器及库

4.  module help 帮助命令

## 以管理员权限运行命令
账户若具有管理员权限，则可以利用sudo命令来以管理员权限运行命令。
```{linux}
sudo R # 以管理员权限运行R
sudo wget https://cf.10xgenomics.com/supp/spatial-exp/refdata-gex-GRCh38-2020-A.tar.gz # 以管理员下载文件
```

## 开辟新的空间
```{linux}
screen -S 001 #开辟一个名为001的运行空间
screen -S 007
Ctrl + A + D  # 从开辟的空间中退出到主界面。
screen -ls # 查看开辟的空间的ID
screen -r ID # 再次进入开辟的空间，查看代码运行情况
kill ID # 删除该运行空间
pkill -u csr3 # 删除该用户的所有运行的空间。
kill 46747
```

## sed命令示例
见网址：
https://www.cnblogs.com/feixiangmanon/p/12043757.html

## vi/vim编辑器的使用
1. 打开文件、保存、关闭文件(vi命令模式下使用)

```{linux}
vi filename       //打开filename文件
:w       //保存文件
:w vpser.net //保存至vpser.net文件
:q          //退出编辑器，如果文件已修改请使用下面的命令
:q!        //退出编辑器，且不保存
:wq         //退出编辑器，且保存文件
```

2. 插入文本或行(vi命令模式下使用，执行下面命令后将进入插入模式，按ESC键可退出插入模式)
```{linux}
a      //在当前光标位置的右边添加文本
i       //在当前光标位置的左边添加文本
A     //在当前行的末尾位置添加文本
I      //在当前行的开始处添加文本(非空字符的行首)
O     //在当前行的上面新建一行
o     //在当前行的下面新建一行
R    //替换(覆盖)当前光标位置及后面的若干文本
J    //合并光标所在行及下一行为一行(依然在命令模式)
```
3. 移动光标(vi命令模式下使用)
```{linux}
1、使用上下左右方向键

2、命令模式下：h   向左、j   向下 、k   向上、l  向右。
空格键 向右、Backspace  向左、Enter  移动到下一行首、-  移动到上一行首。
```
4. 删除、恢复字符或行(vi命令模式下使用)
```{linux}
x         //删除当前字符
nx         //删除从光标开始的n个字符
dd      //删除当前行
ndd   //向下删除当前行在内的n行
u       //撤销上一步操作
U      //撤销对当前行的所有操作
/vpser     //向光标下搜索vpser字符串
?vpser     //向光标上搜索vpser字符串
n           //向下搜索前一个搜素动作
N         //向上搜索前一个搜索动作
```